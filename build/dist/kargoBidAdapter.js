(self.pbjsChunk=self.pbjsChunk||[]).push([[595],{9794:(e,t,r)=>{var n=r(8676),a=r(1218),i=r(433),o=r(9581),c=r(6028),s=r(2707),d=r(8018);const u=Object.freeze({CODE:"kargo",HOST:"krk2.kargo.com",REQUEST_METHOD:"POST",REQUEST_ENDPOINT:"/api/v1/prebid",TIMEOUT_ENDPOINT:"/api/v1/event/timeout",GVLID:972,SUPPORTED_MEDIA_TYPES:[d.D4,d.G_]}),p=(0,s.vM)({bidderCode:u.CODE}),l=Object.freeze({KEY:"currency",US_DOLLAR:"USD"}),E=Object.freeze({USER_DATA:"ortb2.user.data",SOCIAL_CANVAS:"params.socialCanvas",SUA:"ortb2.device.sua",TDID_ADAPTER:"userId.tdid"}),I=Object.freeze({BROWSERS:"browsers",MOBILE:"mobile",MODEL:"model",PLATFORM:"platform",SOURCE:"source"}),g=[I.BROWSERS,I.MOBILE,I.MODEL,I.SOURCE,I.PLATFORM],S=Object.freeze({KEY:"krg_crb",SYNC_URL:"https://crb.kargo.com/api/v1/initsyncrnd/{UUID}?seed={SEED}&idx={INDEX}&gdpr={GDPR}&gdpr_consent={GDPR_CONSENT}&us_privacy={US_PRIVACY}&gpp={GPP_STRING}&gpp_sid={GPP_SID}",SYNC_COUNT:5,PAGE_VIEW_ID:"pageViewId",PAGE_VIEW_TIMESTAMP:"pageViewTimestamp",PAGE_VIEW_URL:"pageViewUrl"});let m,b,f;function D(e,t){const r={};return e&&(r.ortb2=e),t&&(r.refererInfo=t),r}function _(){try{var e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=-177&e[6]|64,e[8]=-65&e[8]|128;var t=Array.prototype.map.call(new Uint8Array(e),(function(e){return("00"+e.toString(16)).slice(-2)})).join("");return t.slice(0,8)+"-"+t.slice(8,12)+"-"+t.slice(12,16)+"-"+t.slice(16,20)+"-"+t.slice(20)}catch(e){return""}}function C(){return m||(m=_()),m}function T(e){try{return p.getDataFromLocalStorage(e)}catch(e){return null}}function O(e,t,r,n,i){const o=R._getCrb(),c={crbIDs:o.syncIds||{}};if(!e&&o.tdID?c.tdID=o.tdID:e&&(c.tdID=e),t&&(c.usp=t),r&&(c.gdpr={consent:r.consentString||"",applies:!!r.gdprApplies}),null!=o.lexId&&(c.kargoID=o.lexId),null!=o.clientId&&(c.clientID=o.clientId),null!=o.optOut&&(c.optOut=o.optOut),null!=n&&(c.sharedIDEids=n),i){const e={};i.consentString&&(e.gppString=i.consentString),i.applicableSections&&(e.applicableSections=i.applicableSections),(0,a.Im)(e)||(c.gpp=e)}return c}const R={gvlid:u.GVLID,code:u.CODE,isBidRequestValid:function(e){return!(!e||!e.params)&&!!e.params.placementId},buildRequests:function(e,t){const r=o.$W.getConfig(l.KEY),n=r&&r.adServerCurrency?r.adServerCurrency:null,c=[];(0,a.bu)(e,(e=>{c.push(function(e){const t={id:e.bidId,tid:e.ortb2Imp?.ext?.tid,pid:e.params.placementId,code:e.adUnitCode};e.bidRequestsCount>0&&(t.bidRequestCount=e.bidRequestsCount);e.bidderRequestsCount>0&&(t.bidderRequestCount=e.bidderRequestsCount);e.bidderWinsCount>0&&(t.bidderWinCount=e.bidderWinsCount);const r=(0,i.A)(e,"ortb2Imp.ext.gpid")||(0,i.A)(e,"ortb2Imp.ext.data.pbadslot");r&&(t.fpd={gpid:r});e.ortb2Imp&&(t.ext={ortb2Imp:e.ortb2Imp});if(e.mediaTypes){const{banner:r,video:n,native:i}=e.mediaTypes;if(r&&(t.banner=r),n&&(t.video=n),i&&(t.native=i),"function"==typeof e.getFloor){let r;try{r=e.getFloor({currency:"USD",mediaType:"*",size:"*"})}catch(e){(0,a.vV)("Kargo: getFloor threw an error: ",e)}t.floor="object"!=typeof r||"USD"!==r.currency||isNaN(parseInt(r.floor))?void 0:r.floor}}return t}(e))}));const s=e[0],d=(0,i.A)(s,E.TDID_ADAPTER),m=function(e){return{pageURL:e?.refererInfo?.page,rawCRB:p.getCookie(S.KEY),rawCRBLocalStorage:T(S.KEY)}}(t),_=Object.assign({},{pbv:"8.52.0-9",aid:s.auctionId,sid:C(),url:m.pageURL,timeout:t.timeout,ts:(new Date).getTime(),device:{size:[window.screen.width,window.screen.height]},imp:c,user:O(d,t.uspConsent,t.gdprConsent,s.userIdAsEids,t.gppConsent),ext:D(s.ortb2,t?.refererInfo)});null!=s.ortb2?.site?.cat&&(_.site={cat:s.ortb2.site.cat}),s.schain&&s.schain.nodes&&(_.schain=s.schain),_.user.data=(0,i.A)(s,E.USER_DATA)||[];const R=function(){if(b===window.location.pathname)return++f;return b=window.location.pathname,f=0}();null!=R&&(_.requestCount=R),null!=n&&n!=l.US_DOLLAR&&(_.cur=n),null!=m.rawCRB&&(_.rawCRB=m.rawCRB),null!=m.rawCRBLocalStorage&&(_.rawCRBLocalStorage=m.rawCRBLocalStorage);const A=(0,i.A)(s,E.SOCIAL_CANVAS);null!=A&&(_.socan=A);const P=(0,i.A)(s,E.SUA);if(P){const e=[];g.forEach((t=>{const r=P[t];if(r&&("string"!=typeof r||""!==r.trim()))switch(t){case I.MOBILE&&r<1:case I.SOURCE&&r<1:break;default:e.push(t)}})),_.device.sua=(0,a.Up)(P,e)}const y=null!=T(S.PAGE_VIEW_ID),U=null!=T(S.PAGE_VIEW_TIMESTAMP),h=null!=T(S.PAGE_VIEW_URL),v={};return y&&(v.id=T(S.PAGE_VIEW_ID)),U&&(v.timestamp=Number(T(S.PAGE_VIEW_TIMESTAMP))),h&&(v.url=T(S.PAGE_VIEW_URL)),(0,a.Im)(v)||(_.page=v),_.ext&&0===Object.keys(_.ext).length&&delete _.ext,Object.assign({},t,{method:u.REQUEST_METHOD,url:`https://${u.HOST}${u.REQUEST_ENDPOINT}`,data:_,currency:n})},interpretResponse:function(e,t){const r=e.body,n=[],i=[];if((0,a.Im)(r)||"object"!=typeof r)return i;for(const[e,a]of Object.entries(r)){let r={mediaType:a.mediaType&&u.SUPPORTED_MEDIA_TYPES.includes(a.mediaType)?a.mediaType:d.D4};a.metadata?.landingPageDomain&&(r.clickUrl=a.metadata.landingPageDomain[0],r.advertiserDomains=a.metadata.landingPageDomain);const o={requestId:e,cpm:Number(a.cpm),width:a.width,height:a.height,ttl:300,creativeId:a.creativeID,dealId:a.targetingCustom,netRevenue:!0,currency:a.currency||t.currency,mediaType:r.mediaType,meta:r};r.mediaType==d.G_?a.admUrl?o.vastUrl=a.admUrl:o.vastXml=a.adm:o.ad=a.adm,i.push(o),a.auctionConfig&&n.push({bidId:e,config:a.auctionConfig})}return n.length>0?{bids:i,fledgeAuctionConfigs:n}:i},getUserSyncs:function(e,t,r,n,a){const i=[],o=_(),c=R._getCrb().clientId;var s=r&&r.gdprApplies?1:0,d=r&&r.consentString?r.consentString:"",u=a&&a.consentString?a.consentString:"",p=a&&a.applicableSections&&Array.isArray(a.applicableSections)?a.applicableSections.join(","):"";if("string"==typeof n&&4==n.length&&1==n[0]&&"Y"==n[2])return i;if(e.iframeEnabled&&o&&c)for(let e=0;e<S.SYNC_COUNT;e++)i.push({type:"iframe",url:S.SYNC_URL.replace("{UUID}",c).replace("{SEED}",o).replace("{INDEX}",e).replace("{GDPR}",s).replace("{GDPR_CONSENT}",d).replace("{US_PRIVACY}",n||"").replace("{GPP_STRING}",u).replace("{GPP_SID}",p)});return i},supportedMediaTypes:u.SUPPORTED_MEDIA_TYPES,onTimeout:function(e){null!=e&&e.forEach((e=>{!function(e,t){let r={aid:e,ato:t};try{let e=(0,a.c$)({protocol:"https",hostname:u.HOST,pathname:u.TIMEOUT_ENDPOINT,search:r});(0,a.z$)(e)}catch(e){}}(e.auctionId,e.timeout)}))},_getCrb:function(){let e=function(){try{return JSON.parse(atob(T(S.KEY)))}catch(e){return{}}}();return Object.keys(e).length?e:function(){try{const e=JSON.parse(p.getCookie(S.KEY));if(e&&e.v){let t=JSON.parse(atob(e.v));if(t)return t}return{}}catch(e){return{}}}()},_getSessionId:C};(0,c.a$)(R),(0,n.E)("kargoBidAdapter"),(0,n.E)("kargoBidAdapter")}},e=>{e.O(0,[802,85],(()=>{return t=9794,e(e.s=t);var t}));e.O()}]);