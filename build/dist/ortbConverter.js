(self.pbjsChunk=self.pbjsChunk||[]).push([[498],{3999:(e,t,n)=>{n.d(t,{T:()=>b,A:()=>f});const i=new WeakMap;var r=n(1218),s=n(433),o=n(8018);const a=new Set(["pos","placement","plcmt","api","mimes","protocols","playbackmethod","minduration","maxduration","w","h","startdelay","placement","linearity","skip","skipmin","skipafter","minbitrate","maxbitrate","delivery","playbackend"]),d={instream:1};var p=n(6220);var c=n(7173),u=n(3897);const m={[c.S3]:{fpd:{priority:99,fn(e,t){(0,r.D9)(e,t.ortb2)}},onlyOneClient:{priority:-99,fn:(0,u.i8)("ORTB request")},props:{fn(e,t){Object.assign(e,{id:e.id||(0,r.lk)(),test:e.test||0});const n=parseInt(t.timeout,10);isNaN(n)||(e.tmax=n)}}},[c.Tb]:{fpd:{priority:99,fn(e,t){(0,r.D9)(e,t.ortb2Imp)}},id:{fn(e,t){e.id=t.bidId}},banner:{fn:function(e,t,n){if(n.mediaType&&n.mediaType!==o.D4)return;const i=(0,s.A)(t,"mediaTypes.banner");if(i){const t={topframe:!0===(0,r.al)()?0:1};i.sizes&&(t.format=(0,r.y$)(i.sizes).map(r.cf)),i.hasOwnProperty("pos")&&(t.pos=i.pos),e.banner=(0,r.D9)(t,e.banner)}}},pbadslot:{fn(e){const t=e.ext?.data?.pbadslot;t&&"string"==typeof t||delete e.ext?.data?.pbadslot}}},[c.WR]:{mediaType:{priority:99,fn:p.K},banner:{fn:function(){let{createPixel:e=e=>(0,r.Tz)(decodeURIComponent(e),r.Bk)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,n){t.mediaType===o.D4&&(n.adm&&n.nurl?(t.ad=n.adm,t.ad+=e(n.nurl)):n.adm?t.ad=n.adm:n.nurl&&(t.adUrl=n.nurl))}}()},props:{fn(e,t,n){Object.entries({requestId:n.bidRequest?.bidId,seatBidId:t.id,cpm:t.price,currency:n.ortbResponse.cur||n.currency,width:t.w,height:t.h,dealId:t.dealid,creative_id:t.crid,creativeId:t.crid,burl:t.burl,ttl:t.exp||n.ttl,netRevenue:n.netRevenue}).filter((e=>{let[t,n]=e;return void 0!==n})).forEach((t=>{let[n,i]=t;return e[n]=i})),e.meta||(e.meta={}),t.adomain&&(e.meta.advertiserDomains=t.adomain),t.ext?.dsa&&(e.meta.dsa=t.ext.dsa)}}}};m[c.Tb].native={fn:function(e,t,n){if(n.mediaType&&n.mediaType!==o.s6)return;let i=t.nativeOrtbRequest;i&&(i=Object.assign({},n.nativeRequest,i),i.assets?.length?e.native=(0,r.D9)({},{request:JSON.stringify(i),ver:i.ver},e.native):(0,r.JE)("mediaTypes.native is set, but no assets were specified. Native request skipped.",t))}},m[c.WR].native={fn:function(e,t){if(e.mediaType===o.s6){let n;if(n="string"==typeof t.adm?JSON.parse(t.adm):t.adm,!(0,r.Qd)(n)||!Array.isArray(n.assets))throw new Error("ORTB native response contained no assets");e.native={ortb:n}}}},m[c.Tb].video={fn:function(e,t,n){if(n.mediaType&&n.mediaType!==o.G_)return;const i=(0,s.A)(t,"mediaTypes.video");if(!(0,r.Im)(i)){const t=Object.fromEntries(Object.entries(i).filter((e=>{let[t]=e;return a.has(t)})));if(i.playerSize){const e=(0,r.y$)(i.playerSize).map(r.cf);e.length>1&&(0,r.JE)("video request specifies more than one playerSize; all but the first will be ignored"),Object.assign(t,e[0])}const n=d[i.context];null!=n&&(t.placement=n),e.video=(0,r.D9)(t,e.video)}}},m[c.WR].video={fn:function(e,t,n){e.mediaType===o.G_&&((0,s.A)(n.imp,"video.w")&&(0,s.A)(n.imp,"video.h")&&([e.playerWidth,e.playerHeight]=[n.imp.video.w,n.imp.video.h]),t.adm&&(e.vastXml=t.adm),t.nurl&&(e.vastUrl=t.nurl))}};var l=n(8653);function f(){let{context:e={},processors:t=b,overrides:n={},imp:s,request:o,bidResponse:a,response:d}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const p=new WeakMap;function u(e,r,s,o){let a;return function(){return null==a&&(a=function(){let a=s.bind(this,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!i.has(e)){const t=Object.entries(e);t.sort(((e,t)=>(e=e[1].priority||0)===(t=t[1].priority||0)?0:e>t?-1:1)),i.set(e,t.map((e=>{let[t,n]=e;return[t,n.fn]})))}const n=i.get(e).filter((e=>{let[n]=e;return!t.hasOwnProperty(n)||t[n]})).map((function(e){let[n,i]=e;return t.hasOwnProperty(n)?t[n].bind(this,i):i}));return function(){const e=Array.from(arguments);n.forEach((t=>{t.apply(this,e)}))}}(t()[e]||{},n[e]||{}));return r&&(a=r.bind(this,a)),function(){try{return a.apply(this,arguments)}catch(e){o.call(this,e,...arguments)}}}()),a.apply(this,arguments)}}const m=u(c.Tb,s,(function(e,t,n){const i={};return e(i,t,n),i}),(function(e,t,n){(0,r.vV)("Error while converting bidRequest to ORTB imp; request skipped.",{error:e,bidRequest:t,context:n})})),l=u(c.S3,o,(function(e,t,n,i){const r={imp:t};return e(r,n,i),r}),(function(e,t,n,i){throw(0,r.vV)("Error while converting to ORTB request",{error:e,imps:t,bidderRequest:n,context:i}),e})),f=u(c.WR,a,(function(e,t,n){const i={};return e(i,t,n),i}),(function(e,t,n){(0,r.vV)("Error while converting ORTB seatbid.bid to bidResponse; bid skipped.",{error:e,bid:t,context:n})})),y=u(c.Cf,d,(function(e,t,n,i){const r={bids:t};return e(r,n,i),r}),(function(e,t,n,i){throw(0,r.vV)("Error while converting from ORTB response",{error:e,bidResponses:t,ortbResponse:n,context:i}),e}));return{toORTB(t){let{bidderRequest:n,bidRequests:i,context:s={}}=t;i=i||n.bids;const o={req:Object.assign({bidRequests:i},e,s),imp:{}};o.req.impContext=o.imp;const a=i.map((t=>{const i=Object.assign({bidderRequest:n,reqContext:o.req},e,s),a=m(t,i);if(null!=a){if(a.hasOwnProperty("id"))return Object.assign(i,{bidRequest:t,imp:a}),o.imp[a.id]=i,a;(0,r.vV)("Converted ORTB imp does not specify an id, ignoring bid request",t,a)}})).filter(Boolean),d=l(a,n,o.req);return o.req.bidderRequest=n,null!=d&&p.set(d,o),d},fromORTB(e){let{request:t,response:n}=e;const i=p.get(t);if(null==i)throw new Error("ortbRequest passed to `fromORTB` must be the same object returned by `toORTB`");function s(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.assign(e,{ortbRequest:t},n,e)}const o=Object.fromEntries((t.imp||[]).map((e=>[e.id,e]))),a=(n.seatbid||[]).flatMap((e=>(e.bid||[]).map((t=>{if(o.hasOwnProperty(t.impid)&&i.imp.hasOwnProperty(t.impid))return f(t,s(i.imp[t.impid],{imp:o[t.impid],seatbid:e,ortbResponse:n}));(0,r.vV)("ORTB response seatbid[].bid[].impid does not match any imp in request; ignoring bid",t)})))).filter(Boolean);return y(a,n,s(i.req))}}}const b=(0,r.Bj)((()=>(0,l.U)(m,(0,c.yB)(c.qN))))},8653:(e,t,n)=>{n.d(t,{U:()=>r});var i=n(7173);function r(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=t.shift(),o=t.length>1?r(...t):t[0];return Object.fromEntries(i.zt.map((e=>[e,Object.assign({},s[e],o[e])])))}},6220:(e,t,n)=>{n.d(t,{K:()=>s,X:()=>r});var i=n(8018);const r={1:i.D4,2:i.G_,4:i.s6};function s(e,t,n){if(e.mediaType)return;const i=n.mediaType;if(!i&&!r.hasOwnProperty(t.mtype))throw new Error("Cannot determine mediaType for response");e.mediaType=i||r[t.mtype]}}}]);